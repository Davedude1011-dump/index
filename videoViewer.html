<!DOCTYPE html>
<html lang="en">
    <head>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="style.css">
        <script src="getContent.js" defer></script>
        <title>INDEX - watching time</title>
    </head>
    <body>
        <!-- PROJECT INDEX -->
        <!-- created by -->

        <div class="viewer-top-panel">
            <div class="viewer-title">s1 e1</div>
            <div class="viewer-title">Seven Deadly Sins</div>
        </div>
        <video class="viewer" id="SevenDeadlySins" controls="" src="https://rr5---sn-aigzrn7e.c.drive.google.com/videoplayback?expire=1672871350&amp;ei=dsW1Y7rtLIbiwtQP0Mi_6AM&amp;ip=2a02:c7e:4eae:e500:d95b:2f3a:ebb4:234&amp;cp=QVRMVElfUFNTQVhPOm85SDhYYzBnWTc0Ym9zY2J5eHpqay1hRERfT3RhUHJocjF6OG5tdUZMaDM&amp;id=3ed4b1316f302903&amp;itag=22&amp;source=webdrive&amp;requiressl=yes&amp;mh=oj&amp;mm=32&amp;mn=sn-aigzrn7e&amp;ms=su&amp;mv=m&amp;mvi=5&amp;pl=41&amp;sc=yes&amp;ttl=transient&amp;susc=dr&amp;driveid=1g9N14uNUFTnYWgsDueg_YG1y1lpMVE0x&amp;app=explorer&amp;mime=video/mp4&amp;vprv=1&amp;prv=1&amp;dur=1463.809&amp;lmt=1672769130805764&amp;mt=1672856457&amp;subapp=DRIVE_WEB_FILE_VIEWER&amp;txp=0011224&amp;sparams=expire,ei,ip,cp,id,itag,source,requiressl,ttl,susc,driveid,app,mime,vprv,prv,dur,lmt&amp;sig=AOq0QJ8wRgIhAPrVOHix_GLQaa_dkX1bnI7dipTnniWCvoN4Q2QBuxRiAiEA-L0OvhKoTiQUV6NtNt5mUZIpI5P_ufUZeiNAekf1Qvg=&amp;lsparams=mh,mm,mn,ms,mv,mvi,pl,sc&amp;lsig=AG3C_xAwRgIhAN39_a7V75TONCkvoD5G7GlerXlALpxvafhTZP5TzAIZAiEAt8TFZZveNh5nCNmYBtOEQuxtTKr8hHBRf3wU5uwjr1Q=&amp;cpn=1TdAc3n17nMG7BlQ&amp;c=WEB_EMBEDDED_PLAYER&amp;cver=1.20221218.00.00"></video>
        <button onclick="nextEp()" style="position: absolute; top: 0; left: 0;">next</button>

        <script>
            // i don't know what kind of voodoo magic this thing does but you bet im happy about it üëç :))))))))
            jQuery(document).ready(function( $ ) {
            
                $("video").on("pause", function(event) {
                  // Save into local storage,if you change the browser will not work
                  localStorage.setItem(btoa(this.src), this.currentTime);
                });
            
                $("video").on("play", function(event) {
                    $storedtime = localStorage.getItem(btoa(this.src));
                    localStorage.setItem("most_recent_video_id", this.id)
                    localStorage.setItem("most_recent_video_src", this.src)
        
                    // Get the time from localStorage and play if not at the end.
                    if ($storedtime < this.duration) 
                        this.currentTime = $storedtime;
            
                    this.play();
                    console.log($storedtime)
                });   
                    
                //if you close the window and video playing store the current time
                $(window).on("unload", function(e) {
                   $("video").each(function(index, value) {
                     if ( ! this.paused ) {
                        localStorage.setItem(btoa(this.src), this.currentTime);
                     }
                  });
                });
                $(window).on("load", function(e) {
                    var recent_video_id = localStorage.getItem("most_recent_video_id")
                    var recent_video_src = localStorage.getItem("most_recent_video_src")
                    console.log(recent_video_id, recent_video_src)
                });
                
             });
        </script>

    </body>
</html>